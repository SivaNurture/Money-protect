import classes from "./form_scafold.module.css";
import { CircularProgress } from "@mui/material";
import StyledPrimaryButton from "../styled/styled_primary_btn";
import { useNavigate } from "react-router-dom";
import loadingImg from "../../assets/images/loading_logo.gif";

const TOTAL_STEPS = 4;

const FormScafold = ({
  step = 1,
  loading = false,
  children,
  onSubmit = () => {},
}) => {
  const navgate = useNavigate();
  const doneIconSVG = (
    <svg
      width="40"
      height="40"
      viewBox="0 0 40 40"
      fill="none"
      xmlns="http://www.w3.org/2000/svg"
    >
      <rect width="40" height="40" rx="20" fill="#D3AB61" fill-opacity="0.2" />
      <path
        d="M20 28.3281C15.6484 28.3281 12.0312 24.7109 12.0312 20.3594C12.0312 16 15.6406 12.3906 19.9922 12.3906C24.3516 12.3906 27.9688 16 27.9688 20.3594C27.9688 24.7109 24.3594 28.3281 20 28.3281ZM19.125 24.1797C19.3906 24.1797 19.6172 24.0547 19.7812 23.7969L23.4531 18.0156C23.5469 17.8516 23.6484 17.6719 23.6484 17.5C23.6484 17.1328 23.3281 16.8984 22.9844 16.8984C22.7812 16.8984 22.5781 17.0234 22.4297 17.2578L19.0938 22.6172L17.5078 20.5703C17.3125 20.3125 17.1406 20.2422 16.9141 20.2422C16.5625 20.2422 16.2891 20.5312 16.2891 20.8828C16.2891 21.0625 16.3594 21.2344 16.4766 21.3906L18.4375 23.7969C18.6406 24.0703 18.8594 24.1797 19.125 24.1797Z"
        fill="#D3AB61"
      />
    </svg>
  );
  return (
    <div className={classes.container}>
      {loading && (
        <div className={classes.loadingIndicator}>
          {<img src={loadingImg} />}
        </div>
      )}
      <div className={classes.headerContainer}>
        <h2>New Application</h2>
      </div>
      <div className={classes.stepHeader}>
        <div
          className={classes.progress}
          style={{ width: `${(step / (TOTAL_STEPS + 1)) * 100}%` }}
        />
        <div className={classes.steps}>
          <div className={classes.stepItem}>
            {step > 1 ? (
              doneIconSVG
            ) : (
              <svg
                width="40"
                height="40"
                viewBox="0 0 40 40"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <rect
                  width="40"
                  height="40"
                  rx="20"
                  fill={step == 1 ? "#D3AB61" : "#F1F3F9"}
                />
                <path
                  d="M20 28.3281C18.8984 28.3281 17.8438 28.0938 16.8828 27.6719C17.6328 26.7891 18.0781 25.6562 18.0781 24.4375C18.0781 24.0391 18.0312 23.6328 17.9375 23.2578C18.5547 23.1094 19.2422 23.0156 19.9922 23.0156C22.3516 23.0156 24.1641 23.8906 24.9297 24.8047C26 23.6406 26.6406 22.0781 26.6406 20.3594C26.6406 16.6719 23.6719 13.7188 19.9922 13.7188C16.6172 13.7188 13.8672 16.1875 13.4375 19.4297C13.0234 19.3828 12.4688 19.4141 12.0859 19.4844C12.5234 15.5234 15.9219 12.3906 19.9922 12.3906C24.3438 12.3906 27.9688 16 27.9688 20.3594C27.9688 24.7109 24.3516 28.3281 20 28.3281ZM19.9922 21.6875C18.4922 21.6719 17.3203 20.4141 17.3125 18.7422C17.2969 17.1641 18.4922 15.8594 19.9922 15.8594C21.4844 15.8594 22.6719 17.1641 22.6719 18.7422C22.6719 20.4219 21.4922 21.7031 19.9922 21.6875ZM13.0391 28.4141C10.8672 28.4141 9.07031 26.6328 9.07031 24.4453C9.07031 22.2734 10.8672 20.4766 13.0391 20.4766C15.2188 20.4766 17.0078 22.2656 17.0078 24.4453C17.0078 26.6172 15.1875 28.4141 13.0391 28.4141ZM12.5625 26.5859C12.7344 26.5859 12.8906 26.5156 12.9766 26.3984L15.2422 23.25C15.3125 23.1484 15.3516 23.0391 15.3516 22.9531C15.3516 22.6797 15.125 22.4688 14.8594 22.4688C14.6797 22.4688 14.5391 22.5547 14.4453 22.6875L12.5469 25.3281L11.5859 24.2891C11.5 24.2031 11.375 24.125 11.2109 24.125C10.9375 24.125 10.7188 24.3359 10.7188 24.6172C10.7188 24.7266 10.7578 24.8672 10.8516 24.9688L12.1719 26.4219C12.2734 26.5312 12.4375 26.5859 12.5625 26.5859Z"
                  fill={step == 1 ? "white" : "#161B27"}
                />
              </svg>
            )}

            <div>
              <h6>Step 1</h6>
              <h5>ID Verification</h5>
            </div>
          </div>
          <div className={classes.stepSeparator} />
          <div className={classes.stepItem}>
            {step > 2 ? (
              doneIconSVG
            ) : (
              <svg
                width="40"
                height="40"
                viewBox="0 0 40 40"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <rect
                  width="40"
                  height="40"
                  rx="20"
                  fill={step == 2 ? "#D3AB61" : "#F1F3F9"}
                />
                <path
                  d="M20 28.3281C15.6484 28.3281 12.0312 24.7109 12.0312 20.3594C12.0312 16 15.6406 12.3906 19.9922 12.3906C24.3516 12.3906 27.9688 16 27.9688 20.3594C27.9688 24.7109 24.3594 28.3281 20 28.3281ZM20 27C23.6875 27 26.6406 24.0469 26.6406 20.3594C26.6406 16.6719 23.6797 13.7188 19.9922 13.7188C16.3047 13.7188 13.3672 16.6719 13.3672 20.3594C13.3672 24.0469 16.3125 27 20 27ZM19.9922 24.8203C19.7812 24.8203 19.625 24.6719 19.625 24.4531V23.8906C18.5781 23.7891 17.7031 23.2109 17.4844 22.3125C17.4609 22.2344 17.4453 22.1562 17.4453 22.0703C17.4453 21.7969 17.6328 21.6094 17.8984 21.6094C18.1328 21.6094 18.2891 21.7344 18.3828 22C18.5078 22.5234 18.9219 22.9141 19.625 23.0156V20.7031L19.5703 20.6875C18.2656 20.3828 17.5938 19.7891 17.5938 18.7969C17.5938 17.7344 18.4375 16.9922 19.625 16.8594V16.3203C19.625 16.1016 19.7812 15.9531 19.9922 15.9531C20.2031 15.9531 20.3594 16.1016 20.3594 16.3203V16.8594C21.3594 16.9766 22.1641 17.5547 22.3672 18.3984C22.3828 18.4844 22.4062 18.5625 22.4062 18.6406C22.4062 18.9141 22.2109 19.1016 21.9453 19.1016C21.6953 19.1016 21.5469 18.9531 21.4688 18.7188C21.3125 18.1953 20.9219 17.8594 20.3594 17.7578V19.9375L20.4688 19.9609C21.8281 20.2031 22.5156 20.8438 22.5156 21.9062C22.5156 23.0859 21.5703 23.7891 20.3594 23.9062V24.4531C20.3594 24.6719 20.2031 24.8203 19.9922 24.8203ZM19.625 19.7422V17.7578C18.9609 17.875 18.5547 18.2734 18.5547 18.75C18.5547 19.2109 18.8672 19.5234 19.5703 19.7266L19.625 19.7422ZM20.3594 20.8906V23.0156C21.1562 22.9219 21.5469 22.5078 21.5469 21.9609C21.5469 21.4609 21.2891 21.1406 20.5312 20.9297L20.3594 20.8906Z"
                  fill={step == 2 ? "white" : "#161B27"}
                />
              </svg>
            )}
            <div>
              <h6>Step 2</h6>
              <h5>Income</h5>
            </div>
          </div>
          <div className={classes.stepSeparator} />
          <div className={classes.stepItem}>
            {step > 3 ? (
              doneIconSVG
            ) : (
              <svg
                width="40"
                height="40"
                viewBox="0 0 40 40"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <rect
                  width="40"
                  height="40"
                  rx="20"
                  fill={step == 3 ? "#D3AB61" : "#F1F3F9"}
                />
                <path
                  d="M20 28.3281C15.6484 28.3281 12.0312 24.7109 12.0312 20.3594C12.0312 16 15.6406 12.3906 19.9922 12.3906C24.3516 12.3906 27.9688 16 27.9688 20.3594C27.9688 24.7109 24.3594 28.3281 20 28.3281ZM20 27C23.6875 27 26.6406 24.0469 26.6406 20.3594C26.6406 16.6719 23.6797 13.7188 19.9922 13.7188C16.3047 13.7188 13.3672 16.6719 13.3672 20.3594C13.3672 24.0469 16.3125 27 20 27ZM19.9297 17.6562C19.3672 17.6562 18.9141 17.2031 18.9141 16.6328C18.9141 16.0625 19.3672 15.6094 19.9297 15.6094C20.5 15.6094 20.9453 16.0625 20.9453 16.6328C20.9453 17.2031 20.5 17.6562 19.9297 17.6562ZM18.6328 24.7344C18.3125 24.7344 18.0625 24.5 18.0625 24.1797C18.0625 23.875 18.3125 23.6328 18.6328 23.6328H19.6016V20.0547H18.7656C18.4453 20.0547 18.1953 19.8203 18.1953 19.5C18.1953 19.1953 18.4453 18.9531 18.7656 18.9531H20.2344C20.6328 18.9531 20.8438 19.2344 20.8438 19.6562V23.6328H21.8125C22.1328 23.6328 22.3828 23.875 22.3828 24.1797C22.3828 24.5 22.1328 24.7344 21.8125 24.7344H18.6328Z"
                  fill={step == 3 ? "white" : "#161B27"}
                />
              </svg>
            )}

            <div>
              <h6>Step 3</h6>
              <h5>Loan Details</h5>
            </div>
          </div>
          <div className={classes.stepSeparator} />
          <div className={classes.stepItem}>
            {step > 4 ? (
              doneIconSVG
            ) : (
              <svg
                width="40"
                height="40"
                viewBox="0 0 40 40"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <rect
                  width="40"
                  height="40"
                  rx="20"
                  fill={step == 4 ? "#D3AB61" : "#F1F3F9"}
                />
                <path
                  d="M13.4297 26.2891V14.4375C13.4297 12.8125 14.2344 11.9844 15.8516 11.9844H24.1484C25.7656 11.9844 26.5703 12.8125 26.5703 14.4375V26.2891C26.5703 27.9219 25.7656 28.7344 24.1484 28.7344H15.8516C14.2344 28.7344 13.4297 27.9219 13.4297 26.2891ZM14.6875 26.2656C14.6875 27.0469 15.1016 27.4766 15.9141 27.4766H24.0859C24.8984 27.4766 25.3125 27.0469 25.3125 26.2656V14.4609C25.3125 13.6797 24.8984 13.2422 24.0859 13.2422H15.9141C15.1016 13.2422 14.6875 13.6797 14.6875 14.4609V26.2656ZM22.0469 19.8984C21.0781 19.8984 20.3047 19.1719 20.3047 17.9219C20.3047 17.2578 20.5234 16.6484 20.9688 16.1719C21.3828 15.7188 22.0391 15.3906 22.5469 15.3906C22.7656 15.3906 22.8828 15.5156 22.8828 15.6797C22.8828 15.8516 22.7891 15.9375 22.5 16.0078C22.1562 16.0859 21.8438 16.2188 21.5938 16.4453C21.3438 16.6719 21.1641 16.9375 21.1016 17.2188H21.2656C21.5078 16.9141 21.8438 16.7812 22.2656 16.7812C23.0938 16.7812 23.6562 17.3906 23.6562 18.3047C23.6562 19.2422 22.9922 19.8984 22.0469 19.8984ZM18.0859 19.9062C17.125 19.9062 16.3516 19.1797 16.3516 17.9297C16.3516 17.2656 16.5703 16.6562 17.0078 16.1797C17.4453 15.7109 18.0781 15.3984 18.5859 15.3984C18.8047 15.3984 18.9219 15.5234 18.9219 15.6875C18.9219 15.8594 18.8359 15.9453 18.5469 16.0156C18.2031 16.0859 17.9062 16.2266 17.6641 16.4375C17.3906 16.6641 17.2109 16.9375 17.1484 17.2266H17.3047C17.5469 16.9219 17.8906 16.7891 18.3047 16.7891C19.1328 16.7891 19.6953 17.3984 19.6953 18.3125C19.6953 19.25 19.0391 19.9062 18.0859 19.9062ZM17.0391 22.5391C16.7578 22.5391 16.5469 22.3203 16.5469 22.0469C16.5469 21.7812 16.7578 21.5781 17.0391 21.5781H22.9688C23.25 21.5781 23.4531 21.7812 23.4531 22.0469C23.4531 22.3203 23.25 22.5391 22.9688 22.5391H17.0391ZM17.0391 25.2578C16.7578 25.2578 16.5469 25.0547 16.5469 24.7891C16.5469 24.5156 16.7578 24.2969 17.0391 24.2969H19.8438C20.125 24.2969 20.3281 24.5156 20.3281 24.7891C20.3281 25.0547 20.125 25.2578 19.8438 25.2578H17.0391Z"
                  fill={step == 4 ? "white" : "#161B27"}
                />
              </svg>
            )}

            <div>
              <h6>Step 4</h6>
              <h5>Agreement</h5>
            </div>
          </div>
        </div>
      </div>
      <div className={classes.formBody}>{children}</div>
      <div className={classes.footer}>
        <div className={classes.footer_items}>
          <div>
            {step !== 1 && (
              <StyledPrimaryButton
                variant="outlined"
                onClick={() => navgate(-1)}
              >
                Go Back
              </StyledPrimaryButton>
            )}
          </div>
          <div>
            <StyledPrimaryButton variant="text">
              Save as Draft
            </StyledPrimaryButton>
            <StyledPrimaryButton onClick={onSubmit}>
              {step == TOTAL_STEPS ? "Pay now" : "Continue"}
            </StyledPrimaryButton>
          </div>
        </div>
      </div>
    </div>
  );
};

export default FormScafold;
